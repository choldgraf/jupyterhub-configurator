# Contributing

`jupyterhub-configurator` has three components:

1. A [tornado](https://torandoweb.org) based [JupyterHub
   service](https://jupyterhub.readthedocs.io/en/stable/reference/services.html)
   written in python, providing the backend for storing and retreiving config
2. A set of mixins to be used with your JupyterHub spawner for dynamic configuration
3. A [react](https://reactjs.org/) based frontend

(contributing:backend)=
## Backend & JupyterHub

Since `jupyterhub-configurator` is run as a JupyterHub service, it is best developed
when run by JupyterHub itself. We ship a `jupyterhub_config.py` that runs a JupyterHub
in development mode with appropriate service setup.

1. Install required dependencies and the configurator package itself
  
   ```bash
   pip install -r requirements.txt
   ```
   
2. Start a jupyterhub. You might first need to `npm install -g configurable-http-proxy`
   as well.

   ```
   jupyterhub
   ```
   
   This should start a JupyterHub on `http://localhost:8000`.
   
3. Log in to the hub with username `admin` and any password. 

4. Open the configurator UI at http://localhost:8000/services/configurator/

You'll need to stop and start the `jupyterhub` process whenever you make a change to
the backend.

## Frontend

This section describes how to set up the right environment and make contributions to the front-end.

### Location of files

The configuration and files for the frontend are contained in the `frontend/` folder.
Most of the files in this folder are configuration for webpack and npm, to control the dependencies and steps needed to build the JavaScript.

The `src/` folder contains the files that define the look and feel of the configurator.
These are mostly arranged into **components** with JavaScript and CSS defined for each section of the configurator page.

The `src/schema.json` file defines the text and structure of the configurator. If you want to edit a description, title, or prompt, this is the place to do it.

When you build the frontend assets via the steps below, these are compiled into a single JavaScript file, and placed in `jupyterhub_configurator/static/`.
**Do not edit this file**, it is programmatically generated.

### Make a change to the frontend

To make a change to the frontend, take these steps:

1. Install `npm`. We use NPM to build the JavaScript for serving the UI. [Here are download instructions for `npm`](https://docs.npmjs.com/downloading-and-installing-node-js-and-npm/).
2. Switch into the `frontent/` directory:

   ```console
   $ cd frontend
   ```

3. Install required dependencies with `npm`.
   
   ```bash
   npm install --no-package-lock
   ```

   This will install all of the necessary `npm` packages to build the configurator.
   Note that the `--no-package-lock` flag will prevent `npm` from over-writing the `package-lock.json` file.
   If you **want** to do this, simply run `npm install` without that flag.

4. Build the dependencies. We use [webpack](https://webpack.js.org/) to build our dependencies. Run it with this command
   
   ```console
   $ npm run dev
   ```

   This will build the dependencies and watch the relevant files for any changes, re-building as necessary.

5. Your configurator page should now be running your latest local build of JS.
   You can preview the results by running the configurator with your JupyterHub (see [](contributing:backend) for more information). You'll need to **refresh the page** to see any changes.
